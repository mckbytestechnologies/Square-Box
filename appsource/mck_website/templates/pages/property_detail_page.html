{% load static %}
{% extends "base.html" %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ property.title }} | Dream Homes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- Colors & Reset --- */
        :root {
            --primary: #2c3e50;
            --secondary: #e74c3c;
            --light: #f8f9fa;
            --dark: #343a40;
            --text: #212529;
            --text-light: #6c757d;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, sans-serif; }
        body { background: var(--light); color: var(--text); line-height: 1.6; }
        .container { max-width: 1200px; margin: auto; padding: 0 20px; }

        /* --- Header --- */
        header { background: var(--primary); color: white; padding: 20px 0; }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 24px; font-weight: bold; }
        .logo span { color: var(--secondary); }
        nav ul { display: flex; list-style: none; }
        nav ul li { margin-left: 20px; }
        nav ul li a { color: white; text-decoration: none; }
        nav ul li a:hover { color: var(--secondary); }

        /* --- Hero --- */
        .property-hero {
            height: 60vh;
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), 
                        url('{% if property.main_image %}{{ property.main_image.url }}{% else %}{% static "images/default-property.jpg" %}{% endif %}') 
                        no-repeat center center/cover;
            color: white; display: flex; align-items: center; margin-bottom: 40px;
        }
        .hero-content { max-width: 800px; padding: 0 20px; }
        .hero-content h1 { font-size: 2.5rem; margin-bottom: 20px; }
        .price { font-size: 1.8rem; font-weight: bold; color: var(--secondary); margin-bottom: 20px; }
        .property-meta { display: flex; flex-wrap: wrap; gap: 30px; }

        /* --- Gallery --- */
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .gallery-item { height: 250px; overflow: hidden; border-radius: 8px; cursor: pointer; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .gallery-item:hover img { transform: scale(1.05); }

        /* --- Details --- */
        .property-details { display: grid; grid-template-columns: 2fr 1fr; gap: 40px; margin-bottom: 50px; }
        @media (max-width: 992px) { .property-details { grid-template-columns: 1fr; } }
        .details-content h2 { color: var(--primary); margin-bottom: 15px; border-bottom: 2px solid var(--secondary); padding-bottom: 5px; }
        .features-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        @media (max-width: 768px) { .features-grid { grid-template-columns: 1fr; } }
        .feature-item { display: flex; align-items: center; gap: 10px; font-size: 1.1rem; }
        .feature-item i { color: var(--secondary); }

        /* --- Map --- */
        .map-container { height: 400px; margin-top: 20px; border-radius: 8px; overflow: hidden; }

        /* --- Footer --- */
        footer { background: var(--dark); color: white; padding: 40px 0; margin-top: 60px; text-align: center; }
        .back-to-list { display: inline-block; margin-top: 40px; padding: 10px 20px; background: var(--primary); color: white; text-decoration: none; border-radius: 4px; }
        .back-to-list:hover { background: var(--secondary); }
    </style>
</head>
<body>


  {% include "includes/header.html" %}

<!-- Hero -->
<section class="property-hero">
    <div class="hero-content container">
        <h1>{{ property.title }}</h1>
        <div class="price">${{ property.price|floatformat:"0" }}</div>
        <div class="property-meta">
            <div><i class="fas fa-bed"></i> {{ property.bedrooms }} Bedroom{{ property.bedrooms|pluralize }}</div>
            <div><i class="fas fa-bath"></i> {{ property.bathrooms }} Bathroom{{ property.bathrooms|pluralize }}</div>
            <div><i class="fas fa-ruler-combined"></i> {{ property.sqft }} sqft</div>
            {% if property.garage > 0 %}<div><i class="fas fa-car"></i> {{ property.garage }} Garage</div>{% endif %}
        </div>
    </div>
</section>

<main class="container">
    <!-- Gallery -->
    <section class="property-gallery">
        <h2>Property Gallery</h2>
        <div class="gallery-grid">
            {% for image in property.images.all %}
                <div class="gallery-item">
                    <img src="{{ image.image.url }}" alt="Property image {{ forloop.counter }}">
                </div>
            {% empty %}
                <p>No images available for this property</p>
            {% endfor %}
        </div>
    </section>

    <!-- Details -->
    <section class="property-details">
        <div class="details-content">
            <h2>About This Property</h2>
            <p>{{ property.description|linebreaks }}</p>
            
            <h2>Property Features</h2>
            <div class="features-grid">
                <div class="feature-item"><i class="fas fa-home"></i> Type: {{ property.property_type.name }}</div>
                <div class="feature-item"><i class="fas fa-calendar-alt"></i> Listed: {{ property.list_date|date:"F j, Y" }}</div>
                <div class="feature-item"><i class="fas fa-map-marker-alt"></i> Location: {{ property.city }}, {{ property.state }}</div>
                <div class="feature-item"><i class="fas fa-tag"></i> Status: {% if property.is_published %}Available{% else %}Not Available{% endif %}</div>
                {% if property.is_hot_selling %}
                    <div class="feature-item"><i class="fas fa-fire"></i> Hot Selling Property</div>
                {% endif %}
            </div>
        </div>
    </section>

    <!-- Location -->
    <section class="location-section">
        <h2>Location</h2>
        <p>{{ property.address }}, {{ property.city }}, {{ property.state }} {{ property.zipcode }}</p>
        <div class="map-container">
            <iframe 
                width="100%" height="100%" frameborder="0"
                src="https://maps.google.com/maps?q={{ property.address|urlencode }},{{ property.city|urlencode }}&output=embed">
            </iframe>
        </div>
    </section>

    <a href="{% url 'property_list' %}" class="back-to-list">
        <i class="fas fa-arrow-left"></i> Back to Properties
    </a>
</main>

{% include "includes/property_display.html" %}
  {% include "includes/footer_main.html" %}
</body>
</html>
{% endblock %}